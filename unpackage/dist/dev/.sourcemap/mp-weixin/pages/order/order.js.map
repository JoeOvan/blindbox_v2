{"version":3,"sources":["uni-app:///main.js","webpack:///D:/Pandora/Dev/blindbox/blindbox-frontend/pages/order/order.vue?cb76","webpack:///D:/Pandora/Dev/blindbox/blindbox-frontend/pages/order/order.vue?6232","webpack:///D:/Pandora/Dev/blindbox/blindbox-frontend/pages/order/order.vue?d8cc","webpack:///D:/Pandora/Dev/blindbox/blindbox-frontend/pages/order/order.vue?6e6e","uni-app:///pages/order/order.vue"],"names":["createPage","Page"],"mappings":";;;;;;;;;;kDAAA;AACA;AACA,4F;AACAA,UAAU,CAACC,cAAD,CAAV,C;;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AAAA;AAAkH;AAClH;AACyD;AACL;;;AAGpD;AACkL;AAClL,gBAAgB,sLAAU;AAC1B,EAAE,2EAAM;AACR,EAAE,gFAAM;AACR,EAAE,yFAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,oFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACtBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAA6qB,CAAgB,4pBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;ACOjsB;AACA,MADA,kBACA;AACA;;;AAGA,GALA;AAMA;AACA,UADA,oBACA;AACA;AACA,gCAFA,CAEA;AACA;AACA,sCADA,CACA;AACA;AACA,KAPA;;AASA;AACA,WAVA,qBAUA;AACA;AACA;AACA;AACA,0DAJA,CAIA;AACA;AACA;AACA,KAjBA;;AAmBA;AACA,iBApBA,yBAoBA,IApBA,EAoBA;AACA;AACA;AACA;AAAA,OACA,IADA,CACA;AACA;AACA;AACA;AACA,SAHA,MAGA;AACA;AACA;AACA;AACA;AACA,WAJA,MAIA;AACA;AACA;AACA,uCARA,CAQA;AACA;AACA,OAfA;AAgBA,UAhBA,CAgBA;AACA;AACA;AACA;AACA;AACA;AACA,OAtBA;AAuBA,KA9CA;;AAgDA;AACA,UAjDA,4KAiDA,KAjDA,EAiDA,MAjDA,EAiDA;AACA;AACA;AACA,sCADA,EACA;AACA,oCAFA;AAGA,0BAHA;AAIA,yBAJA,EAIA;AACA,sBALA;;AAOA;AACA;AACA;AACA;AACA;AACA,SAHA,MAGA;AACA;AACA;AACA,OAPA;AAQA,KAnEA;;AAqEA;AACA,eAtEA,uBAsEA,IAtEA,EAsEA,MAtEA,EAsEA,MAtEA,EAsEA;AACA;AACA;AACA;AACA;AACA,oBADA;AAEA,UAFA,CAEA;AACA;AACA,sBADA,EACA;AACA,kCAFA,EAEA;AACA,0CAHA,EAGA;AACA,wCAJA,EAIA;AACA,0CALA,EAKA;AACA,oCANA,EAMA;AACA,wBAPA;;AASA;AACA;AACA;AACA,oCADA;AAEA,4CAFA,EAEA;AACA,0CAHA,EAGA;AACA,wDAJA,EAIA;AACA,mCALA,EAKA;AACA,qCANA,EAMA;AACA;AACA;AACA,4BADA;AAEA,6BAFA;;AAIA;AACA,sCADA,CACA;AACA,eAFA,EAEA,IAFA;;AAIA,aAhBA;AAiBA;AACA;;AAEA;AACA;AACA,8BADA;AAEA,gCAFA;;;AAKA,eANA,EAMA,IANA;AAOA,oCAVA,CAUA;AACA,aA5BA;AA6BA;AACA,oCADA,CACA;AACA;AACA;AACA,8BADA;AAEA,mCAFA;;AAIA,eALA,EAKA,IALA;AAMA,aArCA;;AAuCA,SAxCA;AAyCA,OAtDA;AAuDA,KAjIA,EANA,E","file":"pages/order/order.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/order/order.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./order.vue?vue&type=template&id=127632e4&\"\nvar renderjs\nimport script from \"./order.vue?vue&type=script&lang=js&\"\nexport * from \"./order.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../Softwave/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/order/order.vue\"\nexport default component.exports","export * from \"-!../../../../../../Softwave/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../Softwave/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../Softwave/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../Softwave/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../Softwave/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Softwave/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./order.vue?vue&type=template&id=127632e4&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../Softwave/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../Softwave/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../Softwave/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../Softwave/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Softwave/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./order.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../Softwave/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../Softwave/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../Softwave/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../Softwave/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Softwave/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./order.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view>\r\n\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tonload() {\r\n\t\t\t\t//先获取code 来获取openid （其实有的可以不用回去openid 看你的支付方式 JSAPI是需要openid的），如果不是uni-app,可写在初始化方法里面按自己需求来\r\n\t\t\t\tvar code = this.getCode(); //先获取code 判断一下code不为空才能获取openid\r\n\t\t\t\tif (this.code != null && this.code != \"\") {\r\n\t\t\t\t\tthis.onBridgeReady(this.code); //把code传给后台获取用户信息\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\t/**先获取code(我是从url上截取的) **/\r\n\t\t\tgetCode() {\r\n\t\t\t\tvar context = '';\r\n\t\t\t\tvar name = 'code';\r\n\t\t\t\tvar reg = new RegExp('(^|&)' + name + '=([^&]*)(&|$)', 'i');\r\n\t\t\t\tvar r = window.location.search.substr(1).match(reg); //获取url中\"?\"符后的字符串并正则匹配\r\n\t\t\t\tif (r != null) context = r[2];\r\n\t\t\t\treturn context;\r\n\t\t\t},\r\n\r\n\t\t\t/**根据返回的code 来获取openid **/\r\n\t\t\tonBridgeReady(code) {\r\n\t\t\t\tvar _this = this;\r\n\t\t\t\tlet token\r\n\t\t\t\tgetAppToken(code) //自己后台写的接口\r\n\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\tif ('999999' == res.code) {\r\n\t\t\t\t\t\t\talert(res.errMsg);\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tif (res.data != null) {\r\n\t\t\t\t\t\t\t\tuni.setStorageSync('openId', res.data);\r\n\t\t\t\t\t\t\t\tuni.setStorageSync('NoPush', false)\r\n\t\t\t\t\t\t\t\ttoken = res.data;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttoken = uni.getStorageSync('openId');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tthis.prepay(this, token); //去支付**\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\tvar code = res.code;\r\n\t\t\t\t\t\talert('openid', '失败')\r\n\t\t\t\t\t\tif ('999999' == res.code) {\r\n\t\t\t\t\t\t\talert(res.errMsg);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\t/**去支付 调用自己的接口 获取相应参数 **/\r\n\t\t\tprepay(_this, openid) {\r\n\t\t\t\t//var _this = this;\r\n\t\t\t\tlet form = {\r\n\t\t\t\t\tamount: _this.totalPrice * 100, //金额\r\n\t\t\t\t\tdistId: _this.addressList.id,\r\n\t\t\t\t\ttradeType: 'JSAPI',\r\n\t\t\t\t\titems: _this.list, //这里的参数是后面调微信支付api需要入的参数信息 如签名，随机字符串，appid等\r\n\t\t\t\t\topenid: openid\r\n\t\t\t\t};\r\n\t\t\t\t_this.addressList.id;\r\n\t\t\t\tprepay(form).then(payRes => { //自己的接口\r\n\t\t\t\t\tif ('999999' == payRes.code) {\r\n\t\t\t\t\t\talert(payRes.errMsg);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t_this.wxPayInvoke(_this, payRes, openid);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\t/**调起微信支付API **/\r\n\t\t\twxPayInvoke(self, payRes, openid) {\r\n\t\t\t\tvar url = window.location.href;\r\n\t\t\t\tlet that = this\r\n\t\t\t\t//获取js签名\r\n\t\t\t\tgetSignature({\r\n\t\t\t\t\taddress: url\r\n\t\t\t\t}).then(res => {\r\n\t\t\t\t\twx.config({\r\n\t\t\t\t\t\tdebug: false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。\r\n\t\t\t\t\t\tappId: payRes.data.appid, // 必填，公众号的唯一标识\r\n\t\t\t\t\t\ttimestamp: payRes.data.timestamp, // 必填，生成签名的时间戳\r\n\t\t\t\t\t\tnonceStr: payRes.data.nonceStr, // 必填，生成签名的随机串\r\n\t\t\t\t\t\tsignature: payRes.data.signature, // 必填，签名\r\n\t\t\t\t\t\tjsApiList: ['chooseWXPay'], // 必填，需要使用的JS接口列表\r\n\t\t\t\t\t\topenId: openid\r\n\t\t\t\t\t});\r\n\t\t\t\t\t//发起微信支付\r\n\t\t\t\t\twx.ready(function() {\r\n\t\t\t\t\t\twx.chooseWXPay({\r\n\t\t\t\t\t\t\tappId: payRes.data.appid,\r\n\t\t\t\t\t\t\ttimestamp: payRes.data.timestamp, // 支付签名时间戳，注意微信jssdk中的所有使用timestamp字段均为小写。但最新版的支付后台生成签名使用的timeStamp字段名需大写其中的S字符\r\n\t\t\t\t\t\t\tnonceStr: payRes.data.noncestr, // 支付签名随机串，不长于 32\r\n\t\t\t\t\t\t\tpackage: 'prepay_id=' + payRes.data.prepayid, // 统一支付接口返回的prepay_id参数值，提交格式如：prepay_id=\\*\\*\\*）\r\n\t\t\t\t\t\t\tsignType: 'HMAC-SHA256', // 签名方式，默认为'SHA1'，使用新版支付需传入'MD5'\r\n\t\t\t\t\t\t\tpaySign: payRes.data.sign, // 支付签名\r\n\t\t\t\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\t\t\t\ttitle: '支付成功'\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\t\t\twindow.history.go(-1) //跳转到上一页\r\n\t\t\t\t\t\t\t\t}, 1000)\r\n\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tcancel: function(res) {\r\n\t\t\t\t\t\t\t\t//提示引用的是mint-UI里toast\r\n\r\n\t\t\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\t\t\t\t\ttitle: '已取消支付'\r\n\t\t\t\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t\t\t}, 2000)\r\n\t\t\t\t\t\t\t\twindow.history.go(-1) //跳转到上一页\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tfail: function(res) {\r\n\t\t\t\t\t\t\t\twindow.history.go(-1) //跳转到上一页\r\n\t\t\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\t\t\t\t\ttitle: '支付失败，请重试'\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t}, 2000)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\r\n</style>\r\n"],"sourceRoot":""}